    -------------------CUBE_MKT4
    
    SELECT  A.TGL, A.OUTLET_PBI, O.NAME CABANG, A.CC_GROUP_ID SEGMEN_ID,
    CG.NAME SEGMEN, 
    DECODE(B.SEGMENTASI_MKT, 'APD','APD',CG.SEGMENT) SEGMENTASI_MKT,
    R.NAME REGION, 
    TO_CHAR(A.TGL,'YYYY') TAHUN,TO_CHAR(A.TGL,'MM') BULAN,
    A.TARGET_VISIT, 
    DECODE(B.VISIT,NULL,0,B.VISIT) VISIT, A.TARGET_REVENUE, 
    DECODE(B.REVENUE,NULL,0,B.REVENUE) REVENUE
    , DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_5
    , DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_5
FROM DAILY_TARGET_SEGMENT A, (
SELECT A.OUTLET_PBI, A.CABANG, A.TGL, A.SEGMEN_ID,A.SEGMEN, A.SEGMENTASI_MKT, A.REGION, A.TAHUN, A.MONTH BULAN,
    SUM(VISIT_PATIENT) VISIT, SUM(TOTAL) REVENUE
FROM CUBE_MKT3 A
GROUP BY A.OUTLET_PBI, A.CABANG, A.TGL, A.SEGMEN_ID,A.SEGMEN, A.SEGMENTASI_MKT, A.REGION, A.TAHUN, A.MONTH) B, OUTLET_PBI O,
    COMPANY_CONTRACT_GROUP CG, METADDT.REGION_ERP R
WHERE A.OUTLET_PBI = B.OUTLET_PBI(+)
    AND A.CC_GROUP_ID = B.SEGMEN_ID(+)
    AND A.TGL = B.TGL(+)
    AND A.OUTLET_PBI = O.OUTLET_PBI(+)
    AND A.CC_GROUP_ID = CG.CC_GROUP_ID(+)
    AND O.REGION_ID = R.PBI_REGION_ID(+)
    AND A.TGL >= '1 JAN 2018';
    AND A.OUTLET_PBI = O.OUTLET_PBI(+)
    AND A.CC_GROUP_ID = CG.CC_GROUP_ID(+)
    AND O.REGION_ID = R.PBI_REGION_ID(+)
    AND A.TGL >= '1 JAN 2018';


TESTING DUMMY

----------CUBE_MKT4
   SELECT  A.TGL, A.OUTLET_PBI, O.NAME CABANG, A.CC_GROUP_ID SEGMEN_ID,
    CG.NAME SEGMEN, 
    DECODE(B.SEGMENTASI_MKT, 'APD','APD',CG.SEGMENT) SEGMENTASI_MKT,
    R.NAME REGION, 
    TO_CHAR(A.TGL,'YYYY') TAHUN,TO_CHAR(A.TGL,'MM') BULAN,
    A.TARGET_VISIT, 
    DECODE(B.VISIT,NULL,0,B.VISIT) VISIT, A.TARGET_REVENUE, 
    DECODE(B.REVENUE,NULL,0,B.REVENUE) REVENUE
    , DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), DECODE(B.VISIT,NULL,0,B.VISIT), 0) VISIT_TAHUN_5
    , DECODE(TO_CHAR(SYSDATE,'YYYY'),TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_0
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-1,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_1
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-2,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_2
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-3,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_3
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-4,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_4
    , DECODE(TO_CHAR(SYSDATE,'YYYY')-5,TO_CHAR(A.TGL,'YYYY'), DECODE(B.REVENUE,NULL,0,B.REVENUE), 0) REV_TAHUN_5
FROM DAILY_TARGET_SEGMENT_ARIS A, (
SELECT A.OUTLET_PBI, A.CABANG, A.TGL, A.SEGMEN_ID,A.SEGMEN, A.SEGMENTASI_MKT, A.REGION, A.TAHUN, A.MONTH BULAN,
    SUM(VISIT_PATIENT) VISIT, SUM(TOTAL) REVENUE
FROM CUBEMKT3_ARIS  A
GROUP BY A.OUTLET_PBI, A.CABANG, A.TGL, A.SEGMEN_ID,A.SEGMEN, A.SEGMENTASI_MKT, A.REGION, A.TAHUN, A.MONTH) B, OUTLET_PBI O,
    TBL_COMPANY_CONTRACT_GROUP CG,TBL_REGION_ERP R
WHERE A.OUTLET_PBI = B.OUTLET_PBI(+)
    AND A.CC_GROUP_ID = B.SEGMEN_ID(+)
    AND A.TGL = B.TGL(+)
    AND A.OUTLET_PBI = O.OUTLET_PBI(+)
    AND A.CC_GROUP_ID = CG.CC_GROUP_ID(+)
    AND O.REGION_ID = R.PBI_REGION_ID(+)
    AND A.TGL >= '1 JAN 2018';